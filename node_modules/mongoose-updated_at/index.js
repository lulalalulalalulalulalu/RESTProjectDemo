/*!
 * Mongoose updatedAt Timestamp Plugin
 * Copyright(c) 2014 Agustin Anfuso
 * MIT Licensed
 */

function updatedAtPlugin (schema, options) {
  var
      options = options || {}
    , createdAt = options['createdAtOn'] || 'createdAt'
    , updatedAt = options['updatedAtOn'] || 'updatedAt';

  var attr = {};
  attr[updatedAt] = { type: Date, dafult: Date.now };

  schema.add(attr);

  schema.pre('save', function (next) {
    var self = this;

    if (self.isNew) {
      self[updatedAt] = self[createdAt];
    } else {
      self[updatedAt] = new Date;
    }

    next();
  });
}

module.exports = updatedAtPlugin;
